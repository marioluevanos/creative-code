const total = 10;
const [logo, divs] = createLogo();
const svg = logo.querySelector("svg");
const logoMark = svg.querySelector('[data-logo="mark"]');
const threesixtyGroup = Array.from(svg.querySelectorAll(
  '[data-logo="threesixty-group"] path'
));
const timeline = createTimeline(divs);
const blue = getComputedStyle(document.documentElement).getPropertyValue(
  "--color-brand"
);

window.addEventListener("load", onLoad);
document.addEventListener("click", () => timeline.restart());

function createLogo() {
  const divs = Array.from({ length: total }, (_, i) => {
    const d = document.createElement("div");
    d.dataset.i = i;
    return d;
  });

  const logo = document.createElement("div");
  logo.classList.add("logo");
  divs.forEach((d) => logo.appendChild(d));
  document.body.appendChild(logo);

  appendSvg(logo);

  return [logo, divs];
}

function createTimeline(divs) {
  const tl = gsap.timeline({
    paused: true,
  });

  tl.set(divs, {
    scale: 0,
  });

  divs.forEach((d) => {
    const i = +d.dataset.i;
    const h = 205;
    const l = 40 - i * 4;
    const s = 85 + i * 10;
    tl.to(
      d,
      {
        delay: 1,
        scale: i * 0.2,
        backgroundColor: `hsl(${h}, ${s}%, ${l}%)`,
        zIndex: total - i,
      },
      `s2+=${i * 0.1}`
    );
  });

  tl.to(
    divs,
    {
      rotate: 360,
      stagger: 0.1,
      duration: 2,
      scale: 1,
      ease: "circ.out",
    },
    "-=0.5"
  );

  tl.add(() => {
    hideDivs();
  });

  tl.set(logoMark, { opacity: 1 });

  tl.add("logo-type");
  tl.to(
    svg,
    {
      scale: 0.25,
      ease: "expo.out",
      duration: 2,
      xPercent: -50,
      left: 100
    },
    "logo-type"
  );
  tl.to(
    threesixtyGroup,
    {
      opacity: 1,
      duration: 0.15,
      stagger: 0.05,
      ease: "expo.out",
    },
    "logo-type"
  );

  tl.to(logo, {
    autoAlpha: 0,
    duration: 0.3,
    ease: "sine.out",
  })

  tl.timeScale(1.5);
  return tl;
}

function hideDivs() {
  divs.forEach((div) => div.remove());
}

function appendSvg(logo) {
  logo.insertAdjacentHTML(
    "afterbegin",
    `
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1232.8 200">
      <g data-logo="threesixty-group">
        <g fill="white">
          <path d="M267.9,56.1h-31V40.9h79.3v15.2h-31v76.3H268L267.9,56.1L267.9,56.1z"/>
          <path d="M323.9,40.9h15.9v33.7c1.6-1.8,4-3.6,7.2-5.3c3.2-1.7,7.2-2.6,12.2-2.6c3.9,0,7.5,0.7,10.5,2c3.2,1.3,5.7,3,7.7,5.4 c2.1,2.4,3.6,5.1,4.8,8.5c1.1,3.3,1.6,6.8,1.6,10.9v39.1h-16.2V93.4c0-4.1-1.1-7.3-3.4-9.6s-5.1-3.4-8.7-3.4 c-2.2,0-4.2,0.4-6.2,1.3c-2,0.9-3.6,2.1-4.9,3.6s-2.4,3.4-3.3,5.4c-0.8,2.1-1.2,4.2-1.2,6.6v34.9h-16.1V40.9L323.9,40.9z"/>
          <path d="M396.1,68.1h15.5l0.4,8c0.8-0.9,1.6-2,2.8-3c1.1-1.1,2.5-2.1,4-3c1.5-0.9,3.4-1.7,5.4-2.3c2.1-0.7,4.5-1,7.1-1 c1.5,0,2.9,0.1,4.2,0.2c1.3,0.1,2.5,0.5,3.8,1l-3.3,15.2c-1.1-0.4-2.2-0.8-3.4-1c-1.1-0.2-2.5-0.2-4-0.2c-2.2,0-4.3,0.3-6.3,1.1 s-3.8,1.7-5.2,3.2c-1.5,1.4-2.6,3-3.5,4.9c-0.9,2-1.3,4.1-1.3,6.4v34.7h-16.2V68.1H396.1z"/>
          <path d="M504.2,123.1c-0.2,0.2-1.1,1-2.3,2.3c-1.2,1.2-3,2.5-5.3,3.9c-2.3,1.4-5.3,2.6-8.9,3.7c-3.6,1.1-7.9,1.6-12.9,1.6 c-5,0-9.8-0.9-14-2.6c-4.2-1.7-7.8-4.1-10.8-7.2c-2.9-3-5.2-6.7-6.8-11.1c-1.6-4.2-2.4-9-2.4-14.2c0-4.8,0.8-9.1,2.4-13.3 c1.6-4,3.8-7.6,6.7-10.7c2.9-3,6.3-5.4,10.3-7.2c4-1.7,8.4-2.6,13.3-2.6c5.9,0,10.9,1.1,14.9,3.3s7.4,5,9.8,8.5 c2.5,3.5,4.2,7.4,5.3,11.7c1.1,4.3,1.6,8.9,1.6,13.5v2.4h-48c0,2.4,0.5,4.6,1.6,6.4c1.1,2,2.4,3.6,4.1,4.9s3.6,2.4,5.8,3.2 c2.2,0.8,4.2,1.1,6.4,1.1c3.2,0,5.9-0.3,8.2-0.9c2.3-0.7,4.3-1.3,6-2.1s3-1.6,4-2.5c1.1-0.9,1.8-1.5,2.4-2.2L504.2,123.1 L504.2,123.1z M488.4,93.4c0-1.6-0.3-3.3-1-4.9c-0.7-1.6-1.6-3.2-2.8-4.5c-1.2-1.3-2.8-2.4-4.8-3.3c-2-0.9-4.1-1.3-6.6-1.3 c-2.6,0-5,0.4-7.1,1.3c-2.1,0.9-3.8,2-5.1,3.3c-1.4,1.3-2.4,2.8-3.2,4.5c-0.8,1.6-1.1,3.3-1.1,4.9H488.4L488.4,93.4z"/>
          <path d="M574.6,123.1c-0.2,0.2-1.1,1-2.3,2.3c-1.2,1.2-3,2.5-5.3,3.9c-2.4,1.4-5.3,2.6-8.9,3.7c-3.6,1.1-7.9,1.6-12.9,1.6 s-9.8-0.9-14-2.6c-4.2-1.7-7.8-4.1-10.8-7.2s-5.2-6.7-6.8-11.1c-1.6-4.2-2.4-9-2.4-14.2c0-4.8,0.8-9.1,2.4-13.3 c1.6-4,3.8-7.6,6.7-10.7c2.9-3,6.3-5.4,10.3-7.2c4-1.7,8.4-2.6,13.3-2.6c5.9,0,10.9,1.1,14.9,3.3s7.4,5,9.8,8.5 c2.5,3.5,4.2,7.4,5.3,11.7c1.1,4.3,1.6,8.9,1.6,13.5v2.4h-48c0,2.4,0.5,4.6,1.6,6.4c1.1,2,2.4,3.6,4.1,4.9c1.7,1.3,3.6,2.4,5.8,3.2 c2.2,0.8,4.2,1.1,6.4,1.1c3.2,0,5.9-0.3,8.2-0.9c2.3-0.7,4.3-1.3,6-2.1c1.6-0.8,3-1.6,4-2.5c1.1-0.9,1.8-1.5,2.4-2.2L574.6,123.1 L574.6,123.1z M558.8,93.4c0-1.6-0.3-3.3-1-4.9c-0.7-1.6-1.6-3.2-2.8-4.5c-1.2-1.3-2.8-2.4-4.8-3.3c-2-0.9-4.1-1.3-6.6-1.3 c-2.6,0-5,0.4-7.1,1.3c-2.1,0.9-3.8,2-5.1,3.3c-1.4,1.3-2.4,2.8-3.2,4.5c-0.8,1.6-1.1,3.3-1.1,4.9H558.8L558.8,93.4z"/>
          <path d="M592.8,106.6c1.1,1.3,2.4,2.6,3.9,4s3.2,2.7,5.1,4c1.8,1.2,4,2.3,6.3,3c2.4,0.9,5,1.2,7.9,1.2c5.4,0,9.5-1.2,12-3.7 c2.6-2.5,3.9-5.4,3.9-8.9c0-2-0.3-3.6-1.1-5.1s-2-2.8-3.7-4c-1.7-1.2-4-2.2-6.7-3c-2.7-0.9-6.2-1.7-10.3-2.6 c-4.2-0.9-7.8-2.1-10.9-3.8s-5.7-3.8-7.6-6.2c-2-2.4-3.5-5-4.6-7.9c-1.1-2.9-1.5-5.9-1.5-8.8c0-3.5,0.7-6.7,2-9.9 c1.3-3.2,3.3-6,5.9-8.4s6-4.3,10-5.9c4-1.4,8.7-2.2,14-2.2c4.9,0,9,0.5,12.5,1.6s6.4,2.4,8.7,3.8c2.4,1.4,4.1,2.9,5.4,4.3 c1.3,1.4,2.2,2.4,2.7,3l-11.4,10.7c-0.4-0.3-1.2-1.1-2.2-2s-2.3-1.8-3.8-2.8c-1.5-0.9-3.3-1.7-5.4-2.5s-4.5-1.1-7.2-1.1 c-2.4,0-4.5,0.3-6.2,1c-1.7,0.7-3.2,1.4-4.3,2.5c-1.1,1-2,2.2-2.5,3.4c-0.5,1.2-0.9,2.4-0.9,3.5c0,1.6,0.3,3.2,0.9,4.3 c0.5,1.2,1.6,2.5,3,3.6c1.4,1.1,3.4,2.1,5.9,2.9c2.5,0.9,5.5,1.6,9.3,2.4c3.6,0.8,7,1.8,10.3,3.3c3.3,1.4,6.2,3.4,8.7,5.7 c2.5,2.4,4.6,5.2,6,8.5c1.5,3.4,2.3,7.4,2.3,12c0,4-0.9,7.7-2.5,11.1c-1.6,3.4-3.9,6.3-6.8,8.9c-2.9,2.6-6.4,4.6-10.4,6 c-4,1.4-8.4,2.2-13.2,2.2c-4.8,0-8.7-0.5-12.4-1.6s-7.1-2.5-10-4.1c-2.9-1.7-5.5-3.6-7.7-5.5c-2.2-2-3.9-3.9-5.4-5.8L592.8,106.6 L592.8,106.6z"/>
          <path d="M662.5,40.9h17.3v17h-17.3V40.9z M663,68.1h16.2v64.3H663V68.1z"/>
          <path d="M709.6,99.8L686.2,68h20.4l12.9,18.7l13-18.7h18.3l-22.7,30.2l25.1,34.2h-20.4l-14.7-21l-14.8,21h-18.3L709.6,99.8 L709.6,99.8z"/>
          <path d="M764,81.3h-11V68.1h11V47.2h16.2v20.9h17.3v13.2h-17.3v28.2c0,3.7,0.7,6.4,1.8,8.5c1.2,2,3.3,2.9,6,2.9 c2.6,0,4.6-0.3,6.1-1.1c1.5-0.8,2.9-1.6,4.3-2.6l6.8,10c-3.3,2.6-6.3,4.6-9.5,5.7c-3.2,1.2-6.6,1.7-10.4,1.7c-3.8,0-7.3-0.5-10-1.7 c-2.7-1.2-5-2.7-6.6-4.9c-1.7-2.1-2.9-4.7-3.6-7.6c-0.8-2.9-1.1-6.2-1.1-9.8L764,81.3L764,81.3z"/>
          <path d="M810.1,145.2c0.9,0.8,2,1.4,3,2.2c1.1,0.8,2.5,1,4.1,1c2.2,0,4-0.9,5.4-2.7s2.9-4.7,4.5-8.5l2.1-5.2l-28.9-63.8H819 l18.4,44l16.2-44h17.7l-26.8,64.3c-1.3,3.2-2.6,6.5-3.8,9.9c-1.3,3.4-2.8,6.5-4.7,9.5c-1.8,2.9-4.1,5.2-7,7.1s-6.2,2.7-10.4,2.7 c-3.7,0-6.7-0.4-9.1-1.3c-2.4-0.9-4.6-2.1-6.4-3.6L810.1,145.2L810.1,145.2z"/>
        </g>
        <g fill="var(--color-brand)">
          <path d="M926.2,84.7H959v37.8c-3.6,3.4-8.3,6.3-14.1,8.9c-5.9,2.5-13.4,3.8-22.5,3.8c-7.5,0-14.2-1.2-20.1-3.7 c-5.9-2.5-10.9-5.9-15-10.1c-4.1-4.2-7.3-9.2-9.5-15c-2.2-5.8-3.3-12-3.3-18.7c0-6.7,1.1-12.9,3.5-18.8c2.3-5.9,5.5-11,9.7-15.3 c4.1-4.3,9.1-7.8,14.9-10.4s12-3.8,18.9-3.8c4.5,0,8.6,0.4,12.4,1.4c3.8,1,7.2,2.3,10.2,3.9c3,1.6,5.8,3.6,8.2,5.9 c2.4,2.3,4.5,4.7,6.3,7.2l-12.2,10.9c-2.9-4.2-6.3-7.6-10.2-10.1c-3.9-2.6-8.8-3.8-14.6-3.8c-4.5,0-8.5,0.9-12.1,2.7 c-3.6,1.7-6.6,4.1-9.1,7.2c-2.5,2.9-4.5,6.4-5.8,10.4c-1.3,4-2,8.2-2,12.5c0,4.9,0.8,9.3,2.4,13.3c1.6,3.9,3.8,7.3,6.6,10.1 c2.8,2.8,6,5,9.8,6.5c3.8,1.5,7.6,2.3,11.7,2.3c8.4,0,14.9-2,19.5-6.1V99.2h-16.3L926.2,84.7L926.2,84.7z"/>
          <path d="M972.2,68.7h15.5l0.4,8c0.8-0.9,1.6-2,2.8-3c1.1-1.1,2.5-2.1,4-3c1.5-0.9,3.4-1.7,5.4-2.3c2.1-0.7,4.5-1,7.1-1 c1.5,0,2.9,0.1,4.1,0.2c1.2,0.2,2.5,0.5,3.8,1l-3.3,15.2c-1.1-0.4-2.2-0.8-3.4-1c-1.1-0.2-2.5-0.2-4-0.2c-2.2,0-4.3,0.3-6.3,1.1 s-3.8,1.7-5.2,3.2c-1.4,1.4-2.6,3-3.5,4.9c-0.9,2-1.3,4.1-1.3,6.4v34.7h-16.2L972.2,68.7L972.2,68.7z"/>
          <path d="M1016.7,100.8c0-4.7,0.9-9,2.5-13.3c1.7-4.1,4-7.8,7.1-10.9s6.6-5.5,10.9-7.4c4.2-1.8,8.9-2.7,14-2.7c5.1,0,9.8,0.9,14,2.7 s7.9,4.3,10.9,7.4c3,3.2,5.3,6.7,7.1,10.9c1.7,4.1,2.5,8.6,2.5,13.3s-0.9,9-2.5,13.3c-1.6,4.2-4,7.8-7.1,11s-6.6,5.7-10.9,7.5 s-8.9,2.7-14,2.7c-5.1,0-9.8-0.9-14-2.7c-4.2-1.8-7.9-4.3-10.9-7.5s-5.3-6.8-7.1-11C1017.5,109.9,1016.7,105.4,1016.7,100.8z M1051.3,121.2c3.2,0,5.8-0.7,8.2-1.8c2.3-1.2,4.1-2.8,5.7-4.9c1.5-2,2.6-4.2,3.4-6.6c0.8-2.4,1.1-4.8,1.1-7.2 c0-2.4-0.3-4.7-1.1-7.1c-0.8-2.4-1.8-4.6-3.4-6.6c-1.5-2.1-3.4-3.6-5.7-4.8c-2.3-1.2-5-1.8-8.2-1.8s-5.8,0.7-8.2,1.8 c-2.3,1.2-4.1,2.8-5.7,4.8c-1.5,2-2.6,4.1-3.4,6.6c-0.8,2.4-1.1,4.8-1.1,7.1s0.3,4.8,1.1,7.2c0.8,2.4,1.8,4.6,3.4,6.6 c1.5,2.1,3.4,3.6,5.7,4.9S1048.2,121.2,1051.3,121.2z"/>
          <path d="M1095.1,68.7h16.2v38.9c0,4.1,1.1,7.3,3.4,9.6c2.3,2.3,5.1,3.4,8.7,3.4c2.2,0,4.2-0.4,6.2-1.3c2-0.9,3.6-2.1,4.9-3.6 c1.4-1.5,2.4-3.4,3.3-5.4c0.8-2.1,1.2-4.2,1.2-6.6V68.7h16.2V133h-15.5l-0.4-7.3c-0.9,0.9-1.8,1.8-3,2.9c-1.2,1-2.6,2-4.1,2.8 c-1.5,0.9-3.4,1.5-5.3,2.2c-2,0.5-4.3,0.9-6.8,0.9c-8,0-14.1-2.4-18.4-7.2c-4.2-4.8-6.3-11.3-6.3-19.5L1095.1,68.7L1095.1,68.7z"/>
          <path d="M1167.5,68.7h15.7l0.4,7.3c0.9-0.9,1.8-1.8,3-2.8c1.2-1,2.7-2,4.3-2.7c1.7-0.9,3.6-1.5,5.8-2.1c2.2-0.5,4.6-0.9,7.2-0.9 c4.9,0,9.2,1,12.8,2.8c3.6,2,6.6,4.5,9,7.6s4.1,6.7,5.3,10.8c1.2,4,1.7,8.2,1.7,12.5c0,5-0.8,9.3-2.2,12.9s-3.3,6.6-5.5,9.3 c-3.7,4.3-7.7,7.5-12,9.2c-4.3,1.7-8.8,2.6-13.4,2.6c-2.1,0-3.9-0.1-5.4-0.2c-1.5-0.2-2.9-0.4-4.1-0.8c-1.2-0.3-2.4-0.7-3.5-1.1 c-1.1-0.4-2.2-0.9-3.4-1.3v28.7h-16.1L1167.5,68.7L1167.5,68.7z M1183.6,117.3c3.2,2.6,8,4,14.6,4c2.9,0,5.5-0.5,7.8-1.7 s4.2-2.6,5.9-4.6c1.6-1.8,2.8-4,3.6-6.4c0.9-2.4,1.2-4.9,1.2-7.4c0-2.7-0.3-5.3-0.9-7.7c-0.7-2.4-1.5-4.5-2.9-6.2 c-1.3-1.7-3-3.2-5.1-4.2s-4.7-1.6-7.8-1.6c-2.5,0-4.7,0.5-6.7,1.6c-2,1.1-3.7,2.4-5.1,4c-1.4,1.6-2.5,3.5-3.3,5.4s-1.2,3.9-1.2,5.7 L1183.6,117.3L1183.6,117.3z"/>
        </g>
      </g>
      <path
        fill="var(--color-brand)"
        data-logo="mark"
        d="M100,0C44.8,0,0,44.8,0,100s44.8,100,100,100s100-44.8,100-100V0H100z M100,140.2 c-22.2,0-40.2-18-40.2-40.2s18-40.2,40.2-40.2s40.2,18,40.2,40.2S122.2,140.2,100,140.2z"/>
    </svg>
  `
  );
}

function onLoad() {
  timeline.restart();
}
